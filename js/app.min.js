function levelToBatch(t){var e,s,a=(new Date).getFullYear();switch(s=2017==a?a+1:a+1+" & "+a,t){case"seven":e=a+5;break;case"eight":e=a+4;break;case"nine":e=a+3;break;case"ten":e=a+2;break;case"tweleven":e=s}return e}function redraw(t){$("input").each(function(){$(this).detach()}),$("#g").attr("class","").text("Welcome");for(var e=1;e<4;e++)$("#pane-"+e).remove(),$("#app .row").append($("<div></div>").addClass("col-lg-4").attr("id","pane-"+e));for(var s=0,a=function(e){var a=e<4?1:e<8?2:3,i=$("<div></div>").addClass("subject"),n=$("<span></span>"),c=$("<input>").attr("type","number").attr("data-subject",e);null!=t&&$(c).val(t[e]),$(n).text(grade.default[e].subject),$(i).append(n).append(c),$("#pane-"+a).append(i),s++},i=0;i<4;i++)a(i);for(var i=4;i<grade.default.length;i++)a(i);if(grade.default.length>8)for(var i=s;i<grade.default.length;i++)a(i);else $("#pane-3").remove(),$("#pane-1").addClass("col-lg-offset-2");$("input").on("change paste keyup input",function(t){if($(this).val().length>4){var e=$(this).val().slice(0,4);$(this).val(e)}state.change(this)}),null!=t&&calculate()}function hopToNext(t){var e=$(t).val();if(4==e.length&&!isInvalidGrade(parseFloat(e))){var s=$("input"),a=parseInt($(s[s.length-1]).attr("data-subject")),i=parseInt($(t).attr("data-subject"));i!=a&&($(t).blur(),$("input[data-subject="+(i+1)+"]").focus())}}function isInvalidGrade(t){var e=parseFloat(t),s=!1;return/[^0-9\.]+/.test(t)?s=!0:e<1||e>5?s=!0:e<3&&e%.25!=0?s=!0:(e>3&&e<4||e>4&&e<5)&&(s=!0),s}function calculate(){var t,e=0,s=0;$("input").each(function(){var t=$(this).val();if(!t)return e=0,!1;if(isInvalidGrade(t))return e=-1,!1;var a=$(this).attr("data-subject");e+=parseFloat(t)*grade.default[a].units,s+=grade.default[a].units}),t=e/s,0==e?$("#g").attr("class","").text("Welcome"):e==-1?$("#g").attr("class","err").text("Error"):($("#g").removeAttr("class").text(t.toPrecision(4)),t<=1.5&&0!=t&&$("#g").addClass("dl"))}$(document).ready(function(){grade.default=grade.seven,state.load(),$("li").each(function(t){$(this).click(function(t){var e=$(this).children();t.preventDefault(),state.update($(e).attr("data-item"),null)});var e=levelToBatch($(this).children().attr("data-item"));$(this).children().text("Batch "+e)}),$("#c_nm").click(function(){var t=$("html").hasClass("night");return state.current.isNightMode=!t,state.save(),t?$("html").removeAttr("class"):$("html").addClass("night")}),$("#hamburger").click(function(){$(this).hasClass("active")?($(this).removeAttr("class"),$("#menu .menu-content").addClass("invis")):($(this).addClass("active"),$("#menu .menu-content").removeClass("invis"))}),$("#refresh").click(redraw)});var state={current:{set:null,grades:[],isNightMode:!1},update:function(t,e){if(grade[t]){var s=levelToBatch(t);if($("#btn-text").text(s),grade.default=grade[t],grade.set=t,this.current.set=t,null==e){this.current.grades=[];for(var a=0;a<grade.default.length;a++)this.current.grades.push("");this.save(),redraw(this.current.grades)}else redraw(e)}else console.log('Invalid gradeset "'+t+'"')},change:function(t){var e=$(t).attr("data-subject"),s=$(t).val();this.current.grades[e]=s,this.save(),calculate()},load:function(){if(void 0!==typeof Storage){var t=localStorage.getItem("gwadata");if(null!=t){var e=JSON.parse(t),s=e.isNightMode,a=e.set,i=e.grades;this.current=e,this.update(a,i),s&&$("html").addClass("night")}else redraw()}},save:function(){if(void 0!==typeof Storage){var t=this.current,e=JSON.stringify(t);localStorage.setItem("gwadata",e),console.log("saved "+e)}}},grade={seven:[{subject:"Integrated Science",units:1.7},{subject:"Mathematics",units:1.7},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1},{subject:"Computer Science",units:1}],eight:[{subject:"Integrated Science",units:2},{subject:"Mathematics",units:1.7},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1},{subject:"Computer Science",units:1},{subject:"Earth Science",units:.7}],nine:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Statistics",units:1},{subject:"Computer Science",units:1},{subject:"Earth Science",units:.7}],ten:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1.3},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"STR",units:1},{subject:"Computer Science",units:1},{subject:"Elective",units:1}],tweleven:[{subject:"Science",units:1.7},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"STR",units:2},{subject:"Additional Science",units:1.7}]};